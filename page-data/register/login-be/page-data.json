{"componentChunkName":"component---src-templates-blog-post-js","path":"/register/login-be/","result":{"data":{"site":{"siteMetadata":{"title":"Buzz Velog"}},"markdownRemark":{"id":"d0a8cf9a-dd15-501b-b501-056c286ca712","excerpt":"회원가입 만들기 백엔드에서의 회원가입 만들기. 회원가입 Backend…","html":"<h1>회원가입 만들기</h1>\n<hr>\n<p>백엔드에서의 회원가입 만들기.</p>\n<h2>회원가입 <strong>Backend</strong> 만들기</h2>\n<h3>생각해야하는 로직</h3>\n<ol>\n<li>유저의 정보를 받기 (이메일, 비밀번호, 유저이름 받을 예정)</li>\n<li>그 정보를 데이터베이스에 저장</li>\n<li>정보중에 비밀번호는 암호화를 해서 저장</li>\n</ol>\n<h3>개발 순서</h3>\n<ol>\n<li>라우터 : 프론트엔드가 정보를 어디 주소로 보내야 할지 알아야 하기 때문에 라우터를 구성.</li>\n<li>모델 : 데이터를 받아서 저장하는 곳.</li>\n<li>데이터 저장 (가입유무 확인, 비밀번호 암호화)</li>\n<li>응답을 보냄.</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ec243bf9b295df50b6257c0b16659488/e8950/file-tree.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 172.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"File-tree\"\n        title=\"\"\n        src=\"/static/ec243bf9b295df50b6257c0b16659488/f058b/file-tree.png\"\n        srcset=\"/static/ec243bf9b295df50b6257c0b16659488/c26ae/file-tree.png 158w,\n/static/ec243bf9b295df50b6257c0b16659488/6bdcf/file-tree.png 315w,\n/static/ec243bf9b295df50b6257c0b16659488/f058b/file-tree.png 630w,\n/static/ec243bf9b295df50b6257c0b16659488/40601/file-tree.png 945w,\n/static/ec243bf9b295df50b6257c0b16659488/78612/file-tree.png 1260w,\n/static/ec243bf9b295df50b6257c0b16659488/e8950/file-tree.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>라우터 만들기</h3>\n<hr>\n<ul>\n<li><code class=\"language-text\">/routes</code> 경로에 <code class=\"language-text\">user.api.js</code> 파일을 생성해준다.</li>\n</ul>\n<p>index.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//import 및 주소를 설정</span>\r\n<span class=\"token keyword\">const</span> userApi <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./user.api\"</span><span class=\"token punctuation\">)</span>\r\n\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/user\"</span><span class=\"token punctuation\">,</span> userApi<span class=\"token punctuation\">)</span></code></pre></div>\n<p>user.api.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//express 서버, 라우터 생성</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\">// 회원가입 endpoint</span>\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"create user controller will be here\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router</code></pre></div>\n<p>라우터가 정상 작동하는지 확인</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a088a9739c7370144b3b891573e249c8/e8950/reg-router.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 84.17721518987341%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB40lEQVR42t1Uy20cMQydMlxAWnApPuaUdJJLfHULuQRBekgtC+x6P/PTf6T56IXk7KyFRQzkkFMEEJQoij89skoxIAaLaZpWGieEEIQ8k/ewzgkfhuFNT2jE118en386fPph8fG7RTUEDdu9Yp5nUZqnGapX6NoOTdug64g3LVEDpTRyzqILZCzzhKdvGo8vGh+eezx86VB58R6QUsIQI0Xl4VgWWRYRh4gUEwLpsENrrehqo9eIF8ClDEtkYiaDzRn2dJAUWZEfRTKcKB3ej+MoEfEd8/LM+3JR8KisMeglrUY8lrec3rIswlfRG8/FPTtgynlBtSlZZ28ey4dKKfmc0hAb6anOmyEuEevx+2qLwHmHVBjcHrLyFnkp51oaY6Xum4ypKpU24/cpvSfn6O5LUuEfr//MYP4bg7fC50VwdP8RC+Or+JSbvPiMEgGV1oq6YvmjN+4GQ8DXg4VPAS4yeZjBidxYI7DSWguEUiIc1pcLjqcT4XDt4RgHmSyGcMYt6P0K2kBY5HPf9wL0SOegOsosC04Z1ALsMxnb7XaoLzWOxyNNlx51XWO/P1wnTYPDYS/7lqbO+XRewc4jrm8lE3a0jbRrDWlaXFPgDpAZSClI2zkPnkjSXpQa1+69xZ3yGymXLmrK/Hb+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"reg-router\"\n        title=\"\"\n        src=\"/static/a088a9739c7370144b3b891573e249c8/f058b/reg-router.png\"\n        srcset=\"/static/a088a9739c7370144b3b891573e249c8/c26ae/reg-router.png 158w,\n/static/a088a9739c7370144b3b891573e249c8/6bdcf/reg-router.png 315w,\n/static/a088a9739c7370144b3b891573e249c8/f058b/reg-router.png 630w,\n/static/a088a9739c7370144b3b891573e249c8/40601/reg-router.png 945w,\n/static/a088a9739c7370144b3b891573e249c8/78612/reg-router.png 1260w,\n/static/a088a9739c7370144b3b891573e249c8/e8950/reg-router.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>모델 만들기</h3>\n<hr>\n<ul>\n<li><code class=\"language-text\">/model</code> 경로에 <code class=\"language-text\">User.js</code> 생성</li>\n</ul>\n<p>/model/User.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//몽고디비 불러오기, 스키마 설정</span>\r\n<span class=\"token keyword\">const</span> mongoose <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mongoose\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> Schema <span class=\"token operator\">=</span> mongoose<span class=\"token punctuation\">.</span>Schema\r\n\r\n<span class=\"token comment\">//userSchema 생성해주기 Schema = 작업지시서</span>\r\n<span class=\"token keyword\">const</span> userSchema <span class=\"token operator\">=</span> <span class=\"token function\">Schema</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">timestamps</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\">// 모델 만들기</span>\r\n<span class=\"token keyword\">const</span> User <span class=\"token operator\">=</span> mongoose<span class=\"token punctuation\">.</span><span class=\"token function\">model</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"User\"</span><span class=\"token punctuation\">,</span> userSchema<span class=\"token punctuation\">)</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> User</code></pre></div>\n<h3>데이터 저장</h3>\n<hr>\n<ul>\n<li><code class=\"language-text\">/controllers/user.controller.js</code> 생성</li>\n</ul>\n<p><code class=\"language-text\">controllers/user.controller.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> Types <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mongoose\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> User <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../models/User\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> bcrypt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bcrypt\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> saltRounds <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\r\n\r\n<span class=\"token keyword\">const</span> userController <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n\r\nuserController<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createUser</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">//프론트 엔드에서 정보 받아오기</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> email<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> password <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body\r\n    <span class=\"token comment\">//이미 가입된 유저인지 체크, eamil => email:email (자바 스크립트 문법)</span>\r\n    <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> User<span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> email <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">throw</span> <span class=\"token string\">\"이미 가입이 된 유저 입니다\"</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">//패스워드 암호화(bcrypt 라이브러리(npm 다운 받아야함))</span>\r\n    <span class=\"token keyword\">const</span> salt <span class=\"token operator\">=</span> bcrypt<span class=\"token punctuation\">.</span><span class=\"token function\">genSaltSync</span><span class=\"token punctuation\">(</span>saltRounds<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">const</span> hash <span class=\"token operator\">=</span> bcrypt<span class=\"token punctuation\">.</span><span class=\"token function\">hashSync</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">,</span> salt<span class=\"token punctuation\">)</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hash\"</span><span class=\"token punctuation\">,</span> hash<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">const</span> newUser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> email<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">password</span><span class=\"token operator\">:</span> hash <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">await</span> newUser<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"success\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> userController</code></pre></div>\n<p><code class=\"language-text\">routers/user.api.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//express 서버, 라우터 생성</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> userController <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../controllers/user.controller\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\">// 회원가입 endpoint</span>\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> userController<span class=\"token punctuation\">.</span>createUser<span class=\"token punctuation\">)</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router</code></pre></div>\n<p>router.post 부분을 model의 userController.createUser와 연결해준다.</p>\n<ul>\n<li>포스트맨으로 API를 전송해본다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7662a1a8448c97fd8d8e30bd453c734c/e8950/postman-api.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACd0lEQVR42qVUWW7UQBD1CXINTsG9kFguwB8fHAXBAbhDkPiIyGQmGe/u1W63H6/KTggjEhKlpFK3repX26sqKh/QeY8xBMQY0bYt9ld77Pd7BP47lbIscXFxoacxBvM8A9GiOR5Q1yWKmGaMc8Y0TaqBoJ5OQohqvCzLX2qtRd91sM5pACZm1MOIY2tR9R7FGAxMs0POswJkgg/9gK7tUDc1vdYoqxIVted/kWWLNk4zXn9u8epjh7P3Dc4+NCimcUQMFimlNUqekdFJuhJliON2Z1loK3a3Oo4TPn33ePfN480Xi7dfHQrP+t2GH3iX777vYIKDZ3pNdcO0LJx1Wg5HW08HZhjQU6UMGvVWksLxUVXVGkFrEqphwpyzprWkCYttscwJ8u60nqq061zCZUlnrGchkQ30JGn5MasueJ4EvmktS5YImPPC4k6aysKmzARO7LwfE6xn/XhGqkb9rwg3Fcm0KcTQs/B6srP9r0s0ncPPq5ZUcBgIalxU44dkLQe0UXeAknJkPYfDNUxVYTAOVbfqTCoJoNDqMZWGasojkUNcp2K5l9qc/6TzFNEuP+fBywE3Wty3WLA8yII7wP9171kReu+UJqfEFZEie9bWTh4xsXGTKCdqjLokPKkm4yl2QenGLsuYef5U0Lx2M2+T4p2H8dwu0ZCXgZPAMRUN64gKqADpOPoN8HA44Mf5ue63m5trdFxNFWmz2+1IHYO2aXQ/yqaR+d1d7rgHOdtDB1cfV8cEl8Uiy6OQiywH8ZZPeCUrTSJf72vkiXN932bZJkREIi2Ea5Zh62pi6q6seEp6CWXndQSfKkps8TDpbosv5qHU8zcJrRgj3P94DAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"postman-api\"\n        title=\"\"\n        src=\"/static/7662a1a8448c97fd8d8e30bd453c734c/f058b/postman-api.png\"\n        srcset=\"/static/7662a1a8448c97fd8d8e30bd453c734c/c26ae/postman-api.png 158w,\n/static/7662a1a8448c97fd8d8e30bd453c734c/6bdcf/postman-api.png 315w,\n/static/7662a1a8448c97fd8d8e30bd453c734c/f058b/postman-api.png 630w,\n/static/7662a1a8448c97fd8d8e30bd453c734c/40601/postman-api.png 945w,\n/static/7662a1a8448c97fd8d8e30bd453c734c/78612/postman-api.png 1260w,\n/static/7662a1a8448c97fd8d8e30bd453c734c/e8950/postman-api.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>여기서 req.body값이 전달이 안돼서 한참 헤맸지만, Body의 타입을 기본값인 TEXT에서 JSON으로 바꿔주니 전달이 잘 되었다.</p>\n</blockquote>\n<ul>\n<li>백엔드 콘솔에서 hash(비밀번호 암호화)가 들어왔는지 확인해본다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3b77d59b6ce65f8640dc4570b8238b86/e8950/console.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.24050632911392%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+klEQVR42p2RW2vDMAyF5cSsLqlJnDhxM+fSjlw2RmlpSdn//2NnIoHSPaxsffg4kiwdG4vMRSP8cKAywForOPJItEReEHJLKFhtTogTVs5dsajN+Dxf4jSluV9rAlWvHmnu8CIV1EpBriRCKUFEzzGMB3TdiGF45xsLZMZiE0W3BiEW7uPfmGd8Jfn5IdRazIUgIIQhQcpFb41/5XIm9B3h8Ckw9AJvO4FyK5DxHxlDUOqfhmYMEHke7glJLZAOAhEb6g2jF4T4yUPDdr9HwYsx1j6/iHuOxxOm6xeu04Sm3aEsS1R1ja1z8L5C2zZomnau11yP4/ih4Te0Wq+FZyc5wwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"console\"\n        title=\"\"\n        src=\"/static/3b77d59b6ce65f8640dc4570b8238b86/f058b/console.png\"\n        srcset=\"/static/3b77d59b6ce65f8640dc4570b8238b86/c26ae/console.png 158w,\n/static/3b77d59b6ce65f8640dc4570b8238b86/6bdcf/console.png 315w,\n/static/3b77d59b6ce65f8640dc4570b8238b86/f058b/console.png 630w,\n/static/3b77d59b6ce65f8640dc4570b8238b86/40601/console.png 945w,\n/static/3b77d59b6ce65f8640dc4570b8238b86/78612/console.png 1260w,\n/static/3b77d59b6ce65f8640dc4570b8238b86/e8950/console.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>추가로 데이터베이스에도 정보가 들어왔는지 확인!</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1bda8de7e533c20c5aca56d447bf53af/e8950/database.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQElEQVR42p1S2UoDQRDc//8dH33zzQdFVAgSBF01m2M32Z275yp7NhuNghjSUMzZVV0zXbWiRzf0MMbi3FDGwDoH8h7Vc7fA624FrQ2IPDxvkg/7kdc55TEp5/wDxxFiRAgBicfKRcBwYvDfIKKRsNcKnRxgPRXGL7KYEnohYK3F1dMDbl7m5Rg2ZFSXsztc3F+j2XbY7gZovpSniooyxTASHFd1OLPWQViDeV3j9nEGVyx3SuCjXUPJHYJRSHwB3nFW+vftDiKFSCrF64SqbDTLNZO2aNhGKzXDQDjLFmi0q1kgniBQoioqUioozYnEc35UYSOrRiS2GiekX5/yF0ZCxeVaLRAdWyaNTAYphIksToTpNMJS5vuiQb3Z4G2QWAqDlXSQ/NOOLRu2XKynUy2Pjzo2JfcS51DYI+XzmvwTdckQOUgdXwcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"database\"\n        title=\"\"\n        src=\"/static/1bda8de7e533c20c5aca56d447bf53af/f058b/database.png\"\n        srcset=\"/static/1bda8de7e533c20c5aca56d447bf53af/c26ae/database.png 158w,\n/static/1bda8de7e533c20c5aca56d447bf53af/6bdcf/database.png 315w,\n/static/1bda8de7e533c20c5aca56d447bf53af/f058b/database.png 630w,\n/static/1bda8de7e533c20c5aca56d447bf53af/40601/database.png 945w,\n/static/1bda8de7e533c20c5aca56d447bf53af/78612/database.png 1260w,\n/static/1bda8de7e533c20c5aca56d447bf53af/e8950/database.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>로그인 만들기</h1>\n<hr>\n<p>백엔드에서의 로그인 만들기.</p>\n<h2>로그인 <strong>Backend</strong> 만들기</h2>\n<h3>생각해야하는 로직</h3>\n<ol>\n<li>유저가 로그인을 하면 데이터베이스에서 로그인 정보를 확인.</li>\n<li>정보가 없다면, 로그인 거부</li>\n<li>정보가 맞다면, 유저정보 + 토큰을 준다.</li>\n<li>프론트엔드는 토큰을 사용하여 로그인 유지.</li>\n</ol>\n<h3>개발 순서</h3>\n<ol>\n<li>라우터 설정</li>\n<li>받은 이메일과 패스워드 정보 읽어오기.</li>\n<li>받은 이메일정보가 디비에 있는지 확인.</li>\n<li>이메일 정보에 해당하는 비밀번호가 맞는지 확인.</li>\n<li>맞다면, 유저정보 + 토큰을 보냄</li>\n<li>틀리면, 에러메시지 보냄</li>\n</ol>\n<h3>라우터 설정</h3>\n<hr>\n<p>routes/user.api.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//express 서버, 라우터 생성</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"express\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> express<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> userController <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../controllers/user.controller\"</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token comment\">// 회원가입 endpoint</span>\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> userController<span class=\"token punctuation\">.</span>createUser<span class=\"token punctuation\">)</span>\r\n<span class=\"token comment\">//로그인 정보는 get에 가깝다는 생각이 들지만, url설정을 유저의 아이디로</span>\r\n<span class=\"token comment\">//하고싶지 않기 때문에 post를 사용한다.</span>\r\n<span class=\"token comment\">//그리고 get은 req,res를 이용해 정보를 주고받지는 못한다.</span>\r\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span> userController<span class=\"token punctuation\">.</span>loginWithEmail<span class=\"token punctuation\">)</span> <span class=\"token comment\">//loginWithEmail 생성 예정</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router</code></pre></div>\n<p>login 라우터를 만들어 준다.</p>\n<h3>토큰 생성</h3>\n<hr>\n<p>토큰 발행을 위한 jsonwebtoken 설치</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> jsonwebtoken</code></pre></div>\n<p>.env</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">JWT_SECRET_KEY</span><span class=\"token operator\">=</span>나만의 Secret key 설정 <span class=\"token punctuation\">(</span>아무거나 가능<span class=\"token punctuation\">)</span></code></pre></div>\n<p>models/User.js</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">const jwt <span class=\"token operator\">=</span> require<span class=\"token punctuation\">(</span><span class=\"token string\">\"jsonwebtoken\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nrequire<span class=\"token punctuation\">(</span><span class=\"token string\">\"dotenv\"</span><span class=\"token punctuation\">)</span>.config<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nconst JWT_SECRET_KEY <span class=\"token operator\">=</span> process.env.JWT_SECRET_KEY<span class=\"token punctuation\">;</span>\r\n\r\n//token생성\r\nuserSchema.methods.generateToken <span class=\"token operator\">=</span> <span class=\"token function-name function\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  const token <span class=\"token operator\">=</span> jwt.sign<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> _id: this._id <span class=\"token punctuation\">}</span>, JWT_SECRET_KEY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token builtin class-name\">return</span> token<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\nmodule.exports <span class=\"token operator\">=</span> User<span class=\"token punctuation\">;</span></code></pre></div>\n<h3>정보확인 및 에러전달</h3>\n<hr>\n<p>controllers/user.controller.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">userController<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">loginWithEmail</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> email<span class=\"token punctuation\">,</span> password <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body\r\n    <span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> User<span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> email <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token comment\">// req에서 보낸 비밀번호와 디비에 암호화된 비밀번호 비교</span>\r\n      <span class=\"token keyword\">const</span> isMatch <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> bcrypt<span class=\"token punctuation\">.</span><span class=\"token function\">compareSync</span><span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">)</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isMatch<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">//토큰 발행하기</span>\r\n        <span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> user<span class=\"token punctuation\">.</span><span class=\"token function\">generateToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"success\"</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">,</span> token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"아이디 또는 비밀번호가 일치하지 않습니다\"</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> error<span class=\"token punctuation\">.</span>message <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>postman 확인</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d836847f17be7ffb1695c74f2a9588f/e8950/postman2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.53164556962025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABBklEQVR42q1Sy07DQAzc//8brvwEHJD4ANQDqqImbPdpewfbgbYgRc2hVkbrjTJjayah1oqUEpgZIoIxxgV2vwdSXkkRrx8Zz+8R4VdwWWbEuMDurTU/ifiuILPA6uVAeHprCCVl5FyQS0VXIUfvKtp1+sC+Gv6IbhtYBYzMu8kbkkq3bQMeWOZ7KOpVzvnHM/JwboPZIpotXb8nJj/Nd+OHHCO+4hlJfTRx1pd7t7kd6ombIOt207Tgcy44FwtCk7P0ZHi/teVWha6CcTrhuGQc54RT1E0bIVdC0gFdRUVFbYCD5drLwP95QdwHcaLBe/3/Oq1n6ytqv/aNVpTGLvonFDy4vgHpbmSezEbAtQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"postman2\"\n        title=\"\"\n        src=\"/static/3d836847f17be7ffb1695c74f2a9588f/f058b/postman2.png\"\n        srcset=\"/static/3d836847f17be7ffb1695c74f2a9588f/c26ae/postman2.png 158w,\n/static/3d836847f17be7ffb1695c74f2a9588f/6bdcf/postman2.png 315w,\n/static/3d836847f17be7ffb1695c74f2a9588f/f058b/postman2.png 630w,\n/static/3d836847f17be7ffb1695c74f2a9588f/40601/postman2.png 945w,\n/static/3d836847f17be7ffb1695c74f2a9588f/78612/postman2.png 1260w,\n/static/3d836847f17be7ffb1695c74f2a9588f/e8950/postman2.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>토큰 유효기간 설정</li>\n</ul>\n<p>models/User.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> jwt<span class=\"token punctuation\">.</span><span class=\"token function\">sign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">_id</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JWT_SECRET_KEY</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">expiresIn</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1d\"</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>불필요한 정보 빼주기</li>\n</ul>\n<p>controllers/user.controller.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> user <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> User<span class=\"token punctuation\">.</span><span class=\"token function\">findOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> email <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-createdAt -updatedAt -__v\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>비밀번호 정보도 빼주기</li>\n</ul>\n<p>비밀번호 정보는 로그인 할 때 뿐만이 아니라 어떠한 형태의 프론트엔드에서 요청하는 유저정보에서도 빼야하기 때문에 따로 설정을 이와같이 해서 영구적으로 제거를 해준다.</p>\n<p>modles/User.js</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 어디서 유저정보를 요청하던 pasword정보 지워주기</span>\r\nuserSchema<span class=\"token punctuation\">.</span>methods<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">toJSON</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_doc\r\n  <span class=\"token keyword\">delete</span> obj<span class=\"token punctuation\">.</span>password\r\n  <span class=\"token keyword\">return</span> obj\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 내용은 코딩알려주는누나 풀스택 강의를 보면서 공부한 내용입니다!!</p>\n<p>관심있으신분들은 <a href=\"https://codingnoona.thinkific.com/\">코딩알려주는누나</a> 강의를 참고하세요!!</p>\n<p>출처: <a href=\"https://codingnoona.thinkific.com/\">코딩알려주는누나</a> 풀스택 강의</p>","frontmatter":{"title":"회원가입 / 로그인 만들기 Backend","date":"October 27, 2023","description":"백엔드에서 회원가입 / 로그인 만들기"}},"previous":null,"next":{"fields":{"slug":"/reg-log-fe/"},"frontmatter":{"title":"회원가입 / 로그인 만들기 Frontend"}}},"pageContext":{"id":"d0a8cf9a-dd15-501b-b501-056c286ca712","previousPostId":null,"nextPostId":"2ff7e130-f74c-5cd9-9f77-78d03948908c"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}